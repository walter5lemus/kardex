{% extends 'base/base.html' %}
{% load staticfiles %}

{% block title %}
	Nuevo Registro
{% endblock %}
{% block header %}

  {% endblock %}


{% block navbar %}
	
	<nav class="navbar navbar-default">
	 	<div class="container-fluid">
		    <div class="navbar-header">
		    </div>
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      
		    	<form class="navbar-form navbar-left" role="search">
		     		<div class="form-group">
		     		</div>
		    	</form>
		    </div>
	   	</div>
	</nav>
	
{% endblock %} 

{% block content %}
<form method="POST">
	{% csrf_token %}
	
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.codigo.name}}">{{ form.codigo.label }}</label>
					{{form.codigo}}
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.fecha.name}}">{{ form.fecha.label }}</label>
					{{form.fecha}}
					
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.concepto.name}}">{{ form.concepto.label }}</label>
					{{form.concepto}}
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.razones.name}}">{{ form.razones.label }}</label>
					{{form.razones}}
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.entrada.name}}">{{ form.entrada.label }}</label>
					{{form.entrada}}
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.salida.name}}">{{ form.salida.label }}</label>
					{{form.salida}}
				</div>
			</div>
		</div>
				<div class="row">
			<div class="col-md-5">
				<div class="form-group">
					<label for="{{form.saldo.name}}">{{ form.saldo.label }}</label>
					{{form.saldo}}
				</div>
			</div>
		</div>


		<div class="col-md-6 col-md-offset-8">
			<div class="form-group">
					<button type="button" onclick="javascript:window.close();" class="btn btn-warning">Cancelar</button>
					<button type="submit" class="btn btn-success" onclick="refreshParent();">Agregar</button>
			</div>
		</div>


</form>
<script>
    window.onunload = refreshParent;
    function refreshParent() {
        window.opener.location.reload();
    }



    $('.fecha').change(function() {
		
		var f = new Date($('#id_fecha_nac_year').val(),$('#id_fecha_nac_month').val() - 1,$('#id_fecha_nac_day').val());
		
		    var today = new Date();
		    var dayDiff = Math.ceil(today - f) / (1000 * 60 * 60 * 24 * 365);
		    var age = parseInt(dayDiff);
		    $('#{{form.edad.auto_id}}').val(age)
		    $('#{{form.edad_registro.auto_id}}').val(age)

		    var date = new Date();
	        var month = date.getMonth()+ 1;
	        var dateString =  date.getFullYear() + "-"+ month + "-" + date.getDate() + " "+ date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds();
	        console.log(dateString);
	        $('#{{form.fecha_hora_creacion.auto_id}}').val(dateString)
	    

	});

	$( function() {
		$.datepicker.setDefaults($.datepicker.regional["es"]);
	    $( "#id_fecha" ).datepicker();
	  } );
</script>


{% endblock %}